<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Read RAV - PHP Chess</title>
  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Read RAV";
    var mkdocs_page_input_path = "read-rav.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> PHP Chess</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">PHP Chess</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../getting-started/">Getting Started</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../read-pgn/">Read PGN</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../read-lan/">Read LAN</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Read RAV</a>
    <ul class="current">
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../convert-fen-to-board/">Convert FEN to Board</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../convert-board-to-png-image/">Convert Board to PNG Image</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../convert-board-to-mp4/">Convert Board to MP4</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../explain-fen/">Explain FEN</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../explain-pgn/">Explain PGN</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../play-like-a-pro/">Play Like a Pro</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../play-computer/">Play Computer</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../heuristics/">Heuristics</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">PHP Chess</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Read RAV</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="read-rav">Read RAV</h1>
<p>âœ¨ RAV stands for Recursive Annotation Variation. This format is especially useful to write and read tutorials about openings, notable games, chess studies and so on.</p>
<p>RAV is an extension of the Standard Algebaric Notation (SAN) format and allows to annotate chess variations. After all, a RAV movetext is still a SAN movetext with support for comments. Comments are enclosed in curly brackets. Variations are enclosed in parentheses which can be nested recursively as many times as required with the trait that the previous move may need to be undone in order to play a certain variation.</p>
<p>The example below describes how to play the Open Sicilian.</p>
<blockquote>
<p>1.e4 c5 {enters the Sicilian Defense, the most popular and best-scoring response to White's first move.} (2.Nf3 {is played in about 80% of Master-level games after which there are three main options for Black.} (2... Nc6) (2... e6) (2... d6 {is Black's most common move.} 3.d4 {lines are collectively known as the Open Sicilian.} cxd4 4.Nxd4 Nf6 5.Nc3 {allows Black choose between four major variations: the Najdorf, Dragon, Classical and Scheveningen.} (5...a6 {is played in the Najdorf variation.}) (5...g6 {is played in the Dragon variation.}) (5...Nc6 {is played in the Classical variation.}) (5...e6 {is played in the Scheveningen variation.})))</p>
</blockquote>
<p>Sicilian Defense. (2023, July 2). In Wikipedia. <a href="https://en.wikipedia.org/wiki/Sicilian_Defence">https://en.wikipedia.org/wiki/Sicilian_Defence</a></p>
<p>Then all you need is a RAV reader.</p>
<p><img alt="Figure 1" src="https://raw.githubusercontent.com/chesslablab/php-chess/master/docs/read-rav_01.png" />
Figure 1. The response received from PHP Chess can be displayed as an HTML table.</p>
<p>The RAV reader shown in Figure 1 displays the variation levels in different shades of gray. It is a 2D scrollable HTML table where the main line is shown in a white background color. The deeper the level, the darker the background color is displayed.</p>
<p>Similarly as with Chess\Play\SanPlay and Chess\Play\LanPlay, <a href="https://github.com/chesslablab/php-chess/blob/master/tests/unit/Play/RavPlayTest.php">Chess\Play\RavPlay</a> allows to play a RAV movetext. The most important method in this class is the <code>getFen()</code> method. This method retrieves the FEN history of a RAV movetext to be displayed for reading purposes as shown in Figure 1.</p>
<pre><code class="language-php">use Chess\Play\RavPlay;

$movetext = &quot;1.e4 c5
    (2.Nf3 (2... Nc6) (2... e6)
        (2... d6 3.d4 cxd4 4.Nxd4 Nf6 5.Nc3
            (5...a6)
            (5...g6)
            (5...Nc6)
            (5...e6)
        )
    )&quot;;

$ravPlay = (new RavPlay($movetext))-&gt;validate();

$fen = $ravPlay-&gt;getFen();

print_r($fen);
</code></pre>
<pre><code class="language-text">Array
(
    [0] =&gt; rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq -
    [1] =&gt; rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3
    [2] =&gt; rnbqkbnr/pp1ppppp/8/2p5/4P3/8/PPPP1PPP/RNBQKBNR w KQkq c6
    [3] =&gt; rnbqkbnr/pp1ppppp/8/2p5/4P3/5N2/PPPP1PPP/RNBQKB1R b KQkq -
    [4] =&gt; r1bqkbnr/pp1ppppp/2n5/2p5/4P3/5N2/PPPP1PPP/RNBQKB1R w KQkq -
    [5] =&gt; rnbqkbnr/pp1p1ppp/4p3/2p5/4P3/5N2/PPPP1PPP/RNBQKB1R w KQkq -
    [6] =&gt; rnbqkbnr/pp2pppp/3p4/2p5/4P3/5N2/PPPP1PPP/RNBQKB1R w KQkq -
    [7] =&gt; rnbqkbnr/pp2pppp/3p4/2p5/3PP3/5N2/PPP2PPP/RNBQKB1R b KQkq d3
    [8] =&gt; rnbqkbnr/pp2pppp/3p4/8/3pP3/5N2/PPP2PPP/RNBQKB1R w KQkq -
    [9] =&gt; rnbqkbnr/pp2pppp/3p4/8/3NP3/8/PPP2PPP/RNBQKB1R b KQkq -
    [10] =&gt; rnbqkb1r/pp2pppp/3p1n2/8/3NP3/8/PPP2PPP/RNBQKB1R w KQkq -
    [11] =&gt; rnbqkb1r/pp2pppp/3p1n2/8/3NP3/2N5/PPP2PPP/R1BQKB1R b KQkq -
    [12] =&gt; rnbqkb1r/1p2pppp/p2p1n2/8/3NP3/2N5/PPP2PPP/R1BQKB1R w KQkq -
    [13] =&gt; rnbqkb1r/pp2pp1p/3p1np1/8/3NP3/2N5/PPP2PPP/R1BQKB1R w KQkq -
    [14] =&gt; r1bqkb1r/pp2pppp/2np1n2/8/3NP3/2N5/PPP2PPP/R1BQKB1R w KQkq -
    [15] =&gt; rnbqkb1r/pp3ppp/3ppn2/8/3NP3/2N5/PPP2PPP/R1BQKB1R w KQkq -
)
</code></pre>
<p>Let's give this a try. Add some comments and get the FEN history.</p>
<pre><code class="language-php">use Chess\Play\RavPlay;

$movetext = &quot;1.e4 c5 {enters the Sicilian Defense.}
    (2.Nf3 (2... Nc6) (2... e6)
        (2... d6 3.d4 cxd4 4.Nxd4 Nf6 5.Nc3
            (5...a6 {is played in the Najdorf variation.})
            (5...g6 {is played in the Dragon variation.})
            (5...Nc6 {is played in the Classical variation.})
            (5...e6 {is played in the Scheveningen variation.})
        )
    )&quot;;

$ravPlay = (new RavPlay($movetext))-&gt;validate();

$fen = $ravPlay-&gt;getFen();

print_r($fen);
</code></pre>
<p>Cool! The result obtained is exactly the same as in the previous example.</p>
<pre><code class="language-text">Array
(
    [0] =&gt; rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq -
    [1] =&gt; rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3
    [2] =&gt; rnbqkbnr/pp1ppppp/8/2p5/4P3/8/PPPP1PPP/RNBQKBNR w KQkq c6
    [3] =&gt; rnbqkbnr/pp1ppppp/8/2p5/4P3/5N2/PPPP1PPP/RNBQKB1R b KQkq -
    [4] =&gt; r1bqkbnr/pp1ppppp/2n5/2p5/4P3/5N2/PPPP1PPP/RNBQKB1R w KQkq -
    [5] =&gt; rnbqkbnr/pp1p1ppp/4p3/2p5/4P3/5N2/PPPP1PPP/RNBQKB1R w KQkq -
    [6] =&gt; rnbqkbnr/pp2pppp/3p4/2p5/4P3/5N2/PPPP1PPP/RNBQKB1R w KQkq -
    [7] =&gt; rnbqkbnr/pp2pppp/3p4/2p5/3PP3/5N2/PPP2PPP/RNBQKB1R b KQkq d3
    [8] =&gt; rnbqkbnr/pp2pppp/3p4/8/3pP3/5N2/PPP2PPP/RNBQKB1R w KQkq -
    [9] =&gt; rnbqkbnr/pp2pppp/3p4/8/3NP3/8/PPP2PPP/RNBQKB1R b KQkq -
    [10] =&gt; rnbqkb1r/pp2pppp/3p1n2/8/3NP3/8/PPP2PPP/RNBQKB1R w KQkq -
    [11] =&gt; rnbqkb1r/pp2pppp/3p1n2/8/3NP3/2N5/PPP2PPP/R1BQKB1R b KQkq -
    [12] =&gt; rnbqkb1r/1p2pppp/p2p1n2/8/3NP3/2N5/PPP2PPP/R1BQKB1R w KQkq -
    [13] =&gt; rnbqkb1r/pp2pp1p/3p1np1/8/3NP3/2N5/PPP2PPP/R1BQKB1R w KQkq -
    [14] =&gt; r1bqkb1r/pp2pppp/2np1n2/8/3NP3/2N5/PPP2PPP/R1BQKB1R w KQkq -
    [15] =&gt; rnbqkb1r/pp3ppp/3ppn2/8/3NP3/2N5/PPP2PPP/R1BQKB1R w KQkq -
)
</code></pre>
<p>In both cases the <code>validate()</code> method will throw a Chess\Exception\PlayException if the RAV movetext is not valid. This is how to obtain the validated movetext.</p>
<pre><code class="language-php">$movetext = $ravPlay-&gt;getRavMovetext()-&gt;getMovetext();
</code></pre>
<p>You may want to remove tabs and spaces from a valid RAV movetext with the help of the <code>filtered()</code> method.</p>
<pre><code class="language-php">$movetext = $ravPlay-&gt;getRavMovetext()-&gt;filtered();

echo $movetext;
</code></pre>
<pre><code class="language-text">1.e4 c5 {enters the Sicilian Defense, the most popular and best-scoring response to White's first move.} (2.Nf3 {is played in about 80% of Master-level games after which there are three main options for Black.} (2...Nc6) (2...e6) (2...d6 {is Black's most common move.} 3.d4 {lines are collectively known as the Open Sicilian.} cxd4 4.Nxd4 Nf6 5.Nc3 {allows Black choose between four major variations: the Najdorf, Dragon, Classical and Scheveningen.} (5...a6 {is played in the Najdorf variation.}) (5...g6 {is played in the Dragon variation.}) (5...Nc6 {is played in the Classical variation.}) (5...e6 {is played in the Scheveningen variation.})))
</code></pre>
<p>Comments are removed by passing the false value to the first argument of the <code>filtered()</code> method.</p>
<pre><code class="language-php">$movetext = $ravPlay-&gt;getRavMovetext()-&gt;filtered($comments = false);

echo $movetext;
</code></pre>
<pre><code class="language-text">1.e4 c5 (2.Nf3 (2...Nc6) (2...e6) (2...d6 3.d4 cxd4 4.Nxd4 Nf6 5.Nc3 (5...a6) (5...g6) (5...Nc6) (5...e6)))
</code></pre>
<p>RAV files can also be loaded from a particular FEN position as opposed to the start position.</p>
<pre><code class="language-php">use Chess\FenToBoard;
use Chess\Play\RavPlay;

$movetext = &quot;1.Ra7 Kg8 2.Kg2 Kf8 3.Kf3 Ke8 4.Ke4 Kd8 5.Kd5 Kc8
    (5...Ke8 6.Kd6 Kf8 7.Ke6 Kg8 8.Kf6 Kh8 9.Kg6 Kg8 10.Ra8#)
    6.Kd6 Kb8
    (6...Kd8 7.Ra8#)
    7.Rc7 Ka8 8.Kc6 Kb8 9.Kb6 Ka8 10.Rc8#&quot;;

$board = FenToBoard::create('7k/8/8/8/8/8/8/R6K w - -');

$ravPlay = (new RavPlay($movetext, $board))-&gt;validate();

$fen = $ravPlay-&gt;getFen();

print_r($fen);
</code></pre>
<pre><code class="language-text">Array
(
    [0] =&gt; 7k/8/8/8/8/8/8/R6K w - -
    [1] =&gt; 7k/R7/8/8/8/8/8/7K b - -
    [2] =&gt; 6k1/R7/8/8/8/8/8/7K w - -
    [3] =&gt; 6k1/R7/8/8/8/8/6K1/8 b - -
    [4] =&gt; 5k2/R7/8/8/8/8/6K1/8 w - -
    [5] =&gt; 5k2/R7/8/8/8/5K2/8/8 b - -
    [6] =&gt; 4k3/R7/8/8/8/5K2/8/8 w - -
    [7] =&gt; 4k3/R7/8/8/4K3/8/8/8 b - -
    [8] =&gt; 3k4/R7/8/8/4K3/8/8/8 w - -
    [9] =&gt; 3k4/R7/8/3K4/8/8/8/8 b - -
    [10] =&gt; 2k5/R7/8/3K4/8/8/8/8 w - -
    [11] =&gt; 4k3/R7/8/3K4/8/8/8/8 w - -
    [12] =&gt; 4k3/R7/3K4/8/8/8/8/8 b - -
    [13] =&gt; 5k2/R7/3K4/8/8/8/8/8 w - -
    [14] =&gt; 5k2/R7/4K3/8/8/8/8/8 b - -
    [15] =&gt; 6k1/R7/4K3/8/8/8/8/8 w - -
    [16] =&gt; 6k1/R7/5K2/8/8/8/8/8 b - -
    [17] =&gt; 7k/R7/5K2/8/8/8/8/8 w - -
    [18] =&gt; 7k/R7/6K1/8/8/8/8/8 b - -
    [19] =&gt; 6k1/R7/6K1/8/8/8/8/8 w - -
    [20] =&gt; R5k1/8/6K1/8/8/8/8/8 b - -
    [21] =&gt; 2k5/R7/3K4/8/8/8/8/8 b - -
    [22] =&gt; 1k6/R7/3K4/8/8/8/8/8 w - -
    [23] =&gt; 3k4/R7/3K4/8/8/8/8/8 w - -
    [24] =&gt; R2k4/8/3K4/8/8/8/8/8 b - -
    [25] =&gt; 1k6/2R5/3K4/8/8/8/8/8 b - -
    [26] =&gt; k7/2R5/3K4/8/8/8/8/8 w - -
    [27] =&gt; k7/2R5/2K5/8/8/8/8/8 b - -
    [28] =&gt; 1k6/2R5/2K5/8/8/8/8/8 w - -
    [29] =&gt; 1k6/2R5/1K6/8/8/8/8/8 b - -
    [30] =&gt; k7/2R5/1K6/8/8/8/8/8 w - -
    [31] =&gt; k1R5/8/1K6/8/8/8/8/8 b - -
)
</code></pre>
<p>ðŸŽ‰ So this is amazing! That's all we need to read and write chess tutorials, guides and how-tos.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../convert-fen-to-board/" class="btn btn-neutral float-right" title="Convert FEN to Board">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../read-lan/" class="btn btn-neutral" title="Read LAN"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../read-lan/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../convert-fen-to-board/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
